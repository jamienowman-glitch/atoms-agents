id: "flow_ghostwriter_chorus"
display_name: "Ghostwriter Chorus Flow"
agents:
  - "agent_ghostwriter_a"
  - "agent_ghostwriter_b"
  - "agent_ghostwriter_c"
goal: "Produce a 3-line chorus. Agent A provides slang draft. Agent B provides Nu Town Clan draft. Agent C polishes and checks constraints."
inputs:
  topic: "Brief description of the song topic"
outputs:
  final_chorus: "The final 3-line chorus"
  constraint_checklist: "List of constraints checked"
stop_conditions:
  max_steps: 10
  timeout_seconds: 60
steps:
  - id: "step_1"
    agent_id: "agent_ghostwriter_a"
    action_type: "generate"
    input_keys: ["topic"]
    output_key: "draft_v1"
    instruction_template: |
      Task: 3-line chorus about '{topic}'. Write draft_v1.
      Output ONLY the draft.
    next: "step_2"

  - id: "step_2"
    agent_id: "agent_ghostwriter_b"
    action_type: "rewrite"
    input_keys: ["topic", "draft_v1"]
    output_key: "draft_v2"
    instruction_template: |
      Task: Rewrite this chorus about '{topic}'.
      Previous context: {draft_v1}
      Write draft_v2.
    next: "step_3"

  - id: "step_3"
    agent_id: "agent_ghostwriter_c"
    action_type: "final"
    input_keys: ["topic", "draft_v2"]
    output_key: "final_chorus"
    instruction_template: |
      Task: Polish this chorus about '{topic}'.
      Previous context: {draft_v2}
      Write final_chorus and constraints_checklist.
    next: null
